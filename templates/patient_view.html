{% extends 'base.html' %}
{% block content %}
  <h2>Patient: {{ patient.first_name }} {{ patient.last_name }}</h2>
  <p><strong>DOB:</strong> {{ patient.dob }} | <strong>Gender:</strong> {{ patient.gender }}</p>
  <p><strong>Phone:</strong> {{ patient.phone }} | <strong>Email:</strong> {{ patient.email }}</p>
  <p><strong>Address:</strong><br>{{ patient.address }}</p>

  <h3>Doctor Notes</h3>
  {% if notes %}
    <ul>
      {% for n in notes %}
        <li>
          <strong>{{ n.title }}</strong> ({{ n.created_at.strftime('%Y-%m-%d %H:%M') }})<br>
          {{ n.body }}<br>
          {% if current_user.role == 'doctor' %}
            <form action="{{ url_for('delete_note', nid=n.id) }}" method="post" style="display:inline" onsubmit="return confirm('Delete note?');">
              <button type="submit">Delete</button>
            </form>
          {% endif %}
        </li>
      {% endfor %}
    </ul>
  {% else %}
    <p>No notes yet.</p>
  {% endif %}

  {% if current_user.role == 'doctor' %}
    <p><a href="{{ url_for('new_note', pid=patient.id) }}">Add Note</a></p>
  {% endif %}
{% endblock %}
